(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c987f17"],{2708:function(t,e,a){"use strict";a.d(e,"a",function(){return s});var s={methods:{handleResult:function(t,e){var a={arrKeys:[],arrTitles:[],tableDatas:[],total:0};if(t&&t.data){var s=t.data;if(s.arrTitles&&s.arrTitles.arrString&&s.arrTitles.arrString.length&&(a.arrTitles=s.arrTitles.arrString),s.arrKeys&&s.arrKeys.arrString&&s.arrKeys.arrString.length&&(a.arrKeys=s.arrKeys.arrString),a.arrKeys.length||(a.arrKeys=a.arrTitles),e||(e=a.arrKeys),s.arrDatas&&s.arrDatas.length)for(var r=0;r<s.arrDatas.length;r++){for(var i={},n=0;n<e.length;n++)i[e[n]]=s.arrDatas[r].arrString[n];a.tableDatas.push(i)}a.total=s.nTotal?s.nTotal:0}return a},IUDSuccess:function(t){return!(t&&t.data&&t.data.hasOwnProperty("result")&&1===t.data.result)},exportData:function(t,e){this.$refs[t].exportCsv({filename:e})}}}},"3d72":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Form",{attrs:{"label-position":"right","label-width":70,inline:""}},[a("FormItem",{attrs:{label:"类型:"}},[a("Select",{staticStyle:{width:"100px"},attrs:{clearable:""},model:{value:t.query.status,callback:function(e){t.$set(t.query,"status",e)},expression:"query.status"}},t._l(t.statuss,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1),a("FormItem",{attrs:{label:"时间选择:"}},[a("Button",{attrs:{type:t.btTypes[3],size:"small"},on:{click:function(e){return t.changeDate(-1)}}},[t._v("昨天")]),a("Button",{attrs:{type:t.btTypes[0],size:"small"},on:{click:function(e){return t.changeDate(1)}}},[t._v("今天")]),a("Button",{attrs:{type:t.btTypes[1],size:"small"},on:{click:function(e){return t.changeDate(7)}}},[t._v("近一周")]),a("Button",{attrs:{type:t.btTypes[2],size:"small"},on:{click:function(e){return t.changeDate(30)}}},[t._v("近一月")]),a("DatePicker",{staticStyle:{width:"200px"},attrs:{value:t.datasTime,format:"yyyy/MM/dd",type:"daterange",clearable:"",placement:"bottom-end",placeholder:"Select date"},on:{"on-change":t.pickerChange,"on-clear":t.clearDate}})],1),a("FormItem",{attrs:{"label-width":1}},[a("Button",{attrs:{type:"primary",loading:t.queryLoading,icon:"ios-search"},on:{click:t.toQuery}},[t._v("查询")])],1),a("FormItem",{attrs:{"label-width":30}},[a("Button",{attrs:{type:"success",loading:t.queryLoading,icon:"checkmark-circled"},on:{click:t.toUpdateAll}},[t._v("全部标为已读")])],1)],1),a("Table",{ref:"selection",attrs:{loading:t.queryLoading,border:"",columns:t.columns,data:t.tableDatas,stripe:""},on:{"on-sort-change":t.sortChange}}),a("Page",{staticClass:"margin-top-10",attrs:{total:t.total,"page-size-opts":[20,50,100],current:t.page,"class-name":"margin-top-10",size:"small","show-total":"","show-elevator":"","show-sizer":"","page-size":20},on:{"on-page-size-change":t.pageSizeChange,"on-change":t.pageChange}})],1)},r=[],i=(a("7f7f"),a("96cf"),a("3b8d")),n=a("cebc"),o=a("2708"),c=a("2f62"),u={mixins:[o["a"]],data:function(){var t=this;return{queryLoading:!1,btTypes:["","","",""],statuss:[{label:"未读",value:"0"},{label:"已读",value:"1"}],loading:!1,query:{status:"0"},datasTime:[],page:1,per_page:20,total:0,columns:[{title:"是否已读",key:"action",align:"center",width:160,render:function(e,a){return e("div",[e("Button",{props:{type:1===a.row.status?"text":"warning",size:"small"},style:{marginRight:"2px"},on:{click:function(){t.toEdit(a.index)}}},1===a.row.status?"已读":" 未读 ")])}},{title:"记录ID",width:100,key:"id"},{title:"触发时间",width:160,key:"created_at"},{title:"引发者",width:160,key:"case_user"},{title:"触发内容",minWidth:160,key:"content"},{title:"已查看管理员",width:160,key:"admin_user"}],tableDatas:[]}},mounted:function(){this.init()},computed:Object(n["a"])({},Object(c["b"])(["name"])),methods:{init:function(){this.queryList()},sortChange:function(t){this.query.order_by=t.key+" "+t.order,this.queryList()},pickerChange:function(t,e){this.datasTime=t,this.clearDate()},clearDate:function(){this.btTypes=["","","",""]},changeDate:function(t){this.datasTime=[];var e=new Date,a=new Date;-1===t&&(this.btTypes=["","","","success"],e.setDate(e.getDate()-1),a.setDate(a.getDate()-1),this.datasTime=[this.getDateFormate(e),this.getDateFormate(a)]),1===t&&(this.btTypes=["success","","",""],this.datasTime=[this.getDateFormate(e),this.getDateFormate(a)]),7===t&&(this.btTypes=["","success","",""],e.setDate(e.getDate()-6),this.datasTime=[this.getDateFormate(e),this.getDateFormate(a)]),30===t&&(this.btTypes=["","","success",""],e.setDate(e.getDate()-29),this.datasTime=[this.getDateFormate(e),this.getDateFormate(a)])},getDateFormate:function(t){return t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()},pageChange:function(t){this.page=t,this.queryList()},pageSizeChange:function(t){this.per_page!==t&&(this.per_page=t,this.queryList())},queryList:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.queryLoading=!0,e=Object(n["a"])({page:this.page,per_page:this.per_page},this.query,{start_time:this.datasTime.length>0&&this.datasTime[0]?this.datasTime[0]:"",end_time:this.datasTime.length>1&&this.datasTime[1]?this.datasTime[1]+" 23:59:59":""}),t.next=5,this.$store.dispatch("getRiskRecords",e);case 5:a=t.sent,a&&a.data&&(this.tableDatas=a.data),this.total=a&&a.meta&&a.meta.total?a.meta.total:0,t.next=12;break;case 10:t.prev=10,t.t0=t["catch"](0);case 12:this.queryLoading=!1;case 13:case"end":return t.stop()}},t,this,[[0,10]])}));function e(){return t.apply(this,arguments)}return e}(),toQuery:function(){this.page=1,this.queryList()},toEdit:function(t){var e=this.tableDatas[t];0===+e.status&&this.saveEdit([e.id])},toUpdateAll:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.$store.dispatch("updateNoReadRiskRecords",{name:this.name});case 4:e=t.sent,e.data&&e.data.hasOwnProperty("result")&&0!==e.data.result?this.$Message.error(e.data.szresult):(this.showEdit=!1,this.$Message.success("修改成功!"),this.toQuery()),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:this.loading=!1;case 11:case"end":return t.stop()}},t,this,[[0,8]])}));function e(){return t.apply(this,arguments)}return e}(),saveEdit:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(e){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.$store.dispatch("updateRiskRecords",{ids:e,name:this.name});case 4:a=t.sent,a.data&&a.data.hasOwnProperty("result")&&0!==a.data.result?this.$Message.error(a.data.szresult):(this.showEdit=!1,this.$Message.success("已读, 修改成功!"),this.toQuery()),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:this.loading=!1;case 11:case"end":return t.stop()}},t,this,[[0,8]])}));function e(e){return t.apply(this,arguments)}return e}()}},l=u,h=(a("b4b4"),a("2877")),d=Object(h["a"])(l,s,r,!1,null,"058934d2",null);e["default"]=d.exports},a7f6:function(t,e,a){},b4b4:function(t,e,a){"use strict";var s=a("a7f6"),r=a.n(s);r.a}}]);
//# sourceMappingURL=chunk-1c987f17.3daf72b1.js.map
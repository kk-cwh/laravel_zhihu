(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1669bf66"],{2218:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Form",{attrs:{"label-position":"right","label-width":1,inline:""}},[a("FormItem",{attrs:{"label-width":1}},[a("Button",{attrs:{type:"error",icon:"plus"},on:{click:t.showAddModal}},[t._v("发红包")])],1),a("FormItem",{attrs:{"label-width":1}},[a("Button",{attrs:{type:"success",icon:"paper-airplane"},on:{click:t.showAddEmailModal}},[t._v("发邮件")])],1),a("FormItem",[a("Button",{attrs:{type:"primary",loading:t.queryLoading,icon:"ios-search"},on:{click:t.toQuery}},[t._v("查询")])],1)],1),a("Table",{ref:"selection",attrs:{loading:t.queryLoading,border:"",columns:t.columns,data:t.tableDatas,stripe:""},on:{"on-sort-change":t.sortChange}}),a("Page",{staticClass:"margin-top-10",attrs:{total:t.total,"page-size-opts":[20,50,100],current:t.page,"class-name":"margin-top-10",size:"small","show-total":"","show-elevator":"","show-sizer":"","page-size":20},on:{"on-page-size-change":t.pageSizeChange,"on-change":t.pageChange}}),a("Modal",{attrs:{title:"发红包",width:"580"},model:{value:t.showAdd,callback:function(e){t.showAdd=e},expression:"showAdd"}},[a("Form",{ref:"formValidate",attrs:{model:t.addRow,rules:t.ruleValidate,"label-position":"right","label-width":160}},[a("FormItem",{attrs:{label:"红包昵称",prop:"redName"}},[a("Input",{staticStyle:{width:"240px"},model:{value:t.addRow.redName,callback:function(e){t.$set(t.addRow,"redName",e)},expression:"addRow.redName"}})],1),a("FormItem",{attrs:{label:"显示金额",prop:"showMoney"}},[a("Input",{staticStyle:{width:"240px"},model:{value:t.addRow.showMoney,callback:function(e){t.$set(t.addRow,"showMoney",e)},expression:"addRow.showMoney"}})],1),a("FormItem",{attrs:{label:"实际金额",prop:"realMoney"}},[a("Input",{staticStyle:{width:"240px"},model:{value:t.addRow.realMoney,callback:function(e){t.$set(t.addRow,"realMoney",e)},expression:"addRow.realMoney"}})],1),a("FormItem",{attrs:{label:"红包个数",prop:"redNum"}},[a("Input",{staticStyle:{width:"240px"},model:{value:t.addRow.redNum,callback:function(e){t.$set(t.addRow,"redNum",e)},expression:"addRow.redNum"}})],1),a("FormItem",{attrs:{label:"指定账号",prop:"account"}},[a("Input",{staticStyle:{width:"320px"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},placeholder:"输入账号, 多个账号用英文逗号隔开, eg:123,234,456"},model:{value:t.addRow.accounts,callback:function(e){t.$set(t.addRow,"accounts",e)},expression:"addRow.accounts"}})],1)],1),a("div",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default"},on:{click:t.cancel}},[t._v("取消")]),a("Button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.toAdd("formValidate")}}},[t._v("保存")])],1)],1),a("Modal",{attrs:{title:"发用户邮件",width:"580"},model:{value:t.showAddEmail,callback:function(e){t.showAddEmail=e},expression:"showAddEmail"}},[a("Form",{ref:"formValidateEmail",attrs:{model:t.addRow,rules:t.ruleValidateEmail,"label-position":"right","label-width":140}},[a("FormItem",{attrs:{label:"标题",prop:"title"}},[a("Input",{staticStyle:{width:"300px"},model:{value:t.addRow.title,callback:function(e){t.$set(t.addRow,"title",e)},expression:"addRow.title"}})],1),a("FormItem",{attrs:{label:"内容",prop:"content"}},[a("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea",autosize:{minRows:6,maxRows:10},placeholder:"输入邮件内容。。。"},model:{value:t.addRow.content,callback:function(e){t.$set(t.addRow,"content",e)},expression:"addRow.content"}})],1),a("FormItem",{attrs:{label:"金额",prop:"money"}},[a("Input",{staticStyle:{width:"150px"},attrs:{placeholder:"0表示没奖励"},model:{value:t.addRow.money,callback:function(e){t.$set(t.addRow,"money",e)},expression:"addRow.money"}})],1),a("FormItem",{attrs:{label:"指定账号",prop:"accounts"}},[a("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},placeholder:"输入账号, 多个账号用英文逗号隔开, eg:123,234,456"},model:{value:t.addRow.accounts,callback:function(e){t.$set(t.addRow,"accounts",e)},expression:"addRow.accounts"}})],1)],1),a("div",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default"},on:{click:t.cancel}},[t._v("取消")]),a("Button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.toSend("formValidateEmail")}}},[t._v("发送")])],1)],1),a("Modal",{attrs:{title:"修改红包设置",width:"580",styles:{top:"100px"}},model:{value:t.showEdit,callback:function(e){t.showEdit=e},expression:"showEdit"}},[a("Form",{ref:"editFormValidate",attrs:{model:t.editRow,"label-position":"right","label-width":140}},[a("FormItem",{attrs:{label:"开始时间"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{value:t.editRow.StartTime,format:"yyyy/MM/dd HH:mm:ss",type:"datetime"},on:{"on-change":t.pickerChangeStartTime}})],1),a("FormItem",{attrs:{label:"结束时间"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{value:t.editRow.EndTime,format:"yyyy/MM/dd HH:mm:ss",type:"datetime"},on:{"on-change":t.pickerChangeEndTime}})],1),a("FormItem",{attrs:{label:"数量"}},[a("Input",{staticStyle:{width:"200px"},model:{value:t.editRow.Amount,callback:function(e){t.$set(t.editRow,"Amount",e)},expression:"editRow.Amount"}})],1),a("FormItem",{attrs:{label:"显示数量"}},[a("Input",{staticStyle:{width:"200px"},model:{value:t.editRow.DisPlayAmount,callback:function(e){t.$set(t.editRow,"DisPlayAmount",e)},expression:"editRow.DisPlayAmount"}})],1),a("FormItem",{attrs:{label:"红包个数"}},[a("Input",{staticStyle:{width:"200px"},model:{value:t.editRow.PlayerNum,callback:function(e){t.$set(t.editRow,"PlayerNum",e)},expression:"editRow.PlayerNum"}})],1)],1),a("div",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default"},on:{click:t.cancel}},[t._v("取消")]),a("Button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.toEdit("editFormValidate")}}},[t._v("确定")])],1)],1)],1)},s=[],i=(a("28a5"),a("7f7f"),a("cebc")),n=(a("96cf"),a("3b8d")),o=(a("a481"),a("c5f6"),a("2708")),l={mixins:[o["a"]],data:function(){return{queryLoading:!1,btTypes:["","","",""],loading:!1,ntypeObj:{qq:"QQ",wx:"微信"},stateObj:{0:"禁用",1:"启用"},query:{ntype:""},datasTime:[],page:1,per_page:20,total:0,showEdit:!1,showAdd:!1,showAddEmail:!1,addRow:{ntype:"qq"},editRow:{},columns:[],tableDatas:[],ruleValidate:{redName:[{required:!0,message:"红包昵称不能为空!",trigger:"change"}],redNum:[{required:!0,message:"红包数量不能为空!",trigger:"change"},{type:"number",message:"请输入合法的数字!",trigger:"blur",transform:function(t){return Number(t)}}],showMoney:[{required:!0,message:"金额不能为空! ",trigger:"blur"},{type:"number",message:"请输入合法的数字!",trigger:"blur",transform:function(t){return Number(t)}}],realMoney:[{required:!0,message:"金额不能为空! ",trigger:"blur"},{type:"number",message:"请输入合法的数字!",trigger:"blur",transform:function(t){return Number(t)}}]},ruleValidateEmail:{title:[{required:!0,message:"标题不能为空!",trigger:"change"}],content:[{required:!0,message:"内容不能为空!",trigger:"change"}],accounts:[{required:!0,message:"账号不能为空!",trigger:"change"}],money:[{required:!0,message:"金额不能为空!",trigger:"change"},{type:"number",message:"请输入合法的数字!",trigger:"blur",transform:function(t){return Number(t)}}]}}},mounted:function(){},computed:{},methods:{init:function(){this.queryList()},sortChange:function(t){this.query.order_by=t.key+" "+t.order,this.queryList()},pickerChangeStartTime:function(t,e){this.editRow.StartTime=t},pickerChangeEndTime:function(t,e){this.editRow.EndTime=t.replace(/00:00:00/,"23:59:59")},pickerChange:function(t,e){this.datasTime=t,this.clearDate()},clearDate:function(){this.btTypes=["","","",""]},changeDate:function(t){this.datasTime=[];var e=new Date,a=new Date;-1===t&&(this.btTypes=["","","","success"],e.setDate(e.getDate()-1),a.setDate(a.getDate()-1),this.datasTime=[this.getDateFormate(e),this.getDateFormate(a)]),1===t&&(this.btTypes=["success","","",""],this.datasTime=[this.getDateFormate(e),this.getDateFormate(a)]),7===t&&(this.btTypes=["","success","",""],e.setDate(e.getDate()-6),this.datasTime=[this.getDateFormate(e),this.getDateFormate(a)]),30===t&&(this.btTypes=["","","success",""],e.setDate(e.getDate()-29),this.datasTime=[this.getDateFormate(e),this.getDateFormate(a)])},getDateFormate:function(t){return t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()},pageChange:function(t){this.page=t,this.queryList()},pageSizeChange:function(t){this.per_page!==t&&(this.per_page=t,this.queryList())},queryList:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,a,r,s,n,o,l,d,c,u=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.queryLoading=!0,e=(this.page-1)*this.per_page,a=this.page*this.per_page,r=Object(i["a"])({page:this.page,per_page:this.per_page,minIndex:e,maxIndex:a>this.total&&this.total&&this.page>1?this.total:a},this.query,{start_time:this.datasTime.length>0&&this.datasTime[0]?this.datasTime[0]:"",end_time:this.datasTime.length>1&&this.datasTime[1]?this.datasTime[1]+" 23:59:59":""}),t.next=7,this.$store.dispatch("getRedPacketSetting",r);case 7:for(s=t.sent,n=this.handleResult(s),this.columns=[],o=n.arrTitles,l=n.arrKeys,d=0;d<l.length;d++)c={title:o[d],sortable:"custom",minWidth:120,align:"center",key:l[d]},"State"===c.key&&(c.render=function(t,e){return t("span",u.stateObj[e.row.State])}),this.columns.push(c);this.columns.push({title:"操作",key:"action",align:"center",width:160,render:function(t,e){return t("div",[t("Button",{props:{type:"success",icon:"compose",size:"small"},style:{marginRight:"2px"},on:{click:function(){u.showEditModal(e.index)}}},"编辑")])}}),this.tableDatas=n.tableDatas,this.total=n.total,t.next=20;break;case 18:t.prev=18,t.t0=t["catch"](0);case 20:this.queryLoading=!1;case 21:case"end":return t.stop()}},t,this,[[0,18]])}));function e(){return t.apply(this,arguments)}return e}(),toQuery:function(){this.page=1,this.queryList()},handleReset:function(t){this.$refs[t].resetFields()},cancel:function(){this.showEdit=!1,this.showAdd=!1,this.showAddEmail=!1},showAddModal:function(){this.showAdd=!0,this.handleReset("formValidate"),this.addRow={}},showAddEmailModal:function(){this.showAddEmail=!0,this.handleReset("formValidateEmail"),this.addRow={}},toAdd:function(t){var e=this;this.$refs[t].validate(function(t){if(t){if(e.addRow.accounts){var a=e.addRow.accounts.split(","),r=a.length;if(a[r-1]||(r-=1),e.addRow.redNum<r)return void e.$Message.error("红包数量不能小于账号数!")}e.add(e.addRow)}})},add:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.$store.dispatch("insertRedPacket",e);case 4:a=t.sent,a.data&&a.data.hasOwnProperty("result")&&0!==a.data.result?this.$Message.error(a.data.szresult):(this.showAdd=!1,this.$Message.success("添加成功!")),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:this.loading=!1;case 11:case"end":return t.stop()}},t,this,[[0,8]])}));function e(e){return t.apply(this,arguments)}return e}(),toSend:function(t){var e=this;this.$refs[t].validate(function(t){t&&e.sendEmail(e.addRow)})},sendEmail:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.$store.dispatch("insertUserMessage",e);case 4:a=t.sent,a.data&&a.data.hasOwnProperty("result")&&0!==a.data.result?this.$Message.error(a.data.szresult):(this.showAddEmail=!1,this.$Message.success("发送成功!")),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:this.loading=!1;case 11:case"end":return t.stop()}},t,this,[[0,8]])}));function e(e){return t.apply(this,arguments)}return e}(),showEditModal:function(t){this.showEdit=!0,this.editRow={StartTime:this.tableDatas[t].StartTime.length<=10?this.tableDatas[t].StartTime+" 00:00:00":this.tableDatas[t].StartTime,EndTime:this.tableDatas[t].EndTime.length<=10?this.tableDatas[t].EndTime+" 00:00:00":this.tableDatas[t].EndTime,Amount:this.tableDatas[t].Amount,DisPlayAmount:this.tableDatas[t].DisPlayAmount,PlayerNum:this.tableDatas[t].PlayerNum}},toEdit:function(t){this.saveEdit(this.editRow)},saveEdit:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a,r=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.$store.dispatch("updateRedPacketSetting",e);case 4:a=t.sent,a.data&&a.data.hasOwnProperty("result")&&0!==a.data.result?this.$Message.error(a.data.szresult):(this.showEdit=!1,this.$Message.success("修改成功!"),setTimeout(function(){r.toQuery()},1e3)),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:this.loading=!1;case 11:case"end":return t.stop()}},t,this,[[0,8]])}));function e(e){return t.apply(this,arguments)}return e}(),toDelete:function(t){this.delRow=Object(i["a"])({},this.tableDatas[t]);var e={AccountName:this.delRow.AccountName};this.deleteRow(e)},deleteRow:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.$store.dispatch("deleteMerchantSetting",e);case 4:a=t.sent,a.data&&a.data.hasOwnProperty("result")&&0!==a.data.result?this.$Message.error(a.data.szresult):(this.showEdit=!1,this.$Message.success("删除成功!"),this.toQuery()),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:this.loading=!1;case 11:case"end":return t.stop()}},t,this,[[0,8]])}));function e(e){return t.apply(this,arguments)}return e}()}},d=l,c=(a("6b86"),a("2877")),u=Object(c["a"])(d,r,s,!1,null,"70ec9bdc",null);e["default"]=u.exports},2708:function(t,e,a){"use strict";a.d(e,"a",function(){return r});var r={methods:{handleResult:function(t,e){var a={arrKeys:[],arrTitles:[],tableDatas:[],total:0};if(t&&t.data){var r=t.data;if(r.arrTitles&&r.arrTitles.arrString&&r.arrTitles.arrString.length&&(a.arrTitles=r.arrTitles.arrString),r.arrKeys&&r.arrKeys.arrString&&r.arrKeys.arrString.length&&(a.arrKeys=r.arrKeys.arrString),a.arrKeys.length||(a.arrKeys=a.arrTitles),e||(e=a.arrKeys),r.arrDatas&&r.arrDatas.length)for(var s=0;s<r.arrDatas.length;s++){for(var i={},n=0;n<e.length;n++)i[e[n]]=r.arrDatas[s].arrString[n];a.tableDatas.push(i)}a.total=r.nTotal?r.nTotal:0}return a},IUDSuccess:function(t){return!(t&&t.data&&t.data.hasOwnProperty("result")&&1===t.data.result)},exportData:function(t,e){this.$refs[t].exportCsv({filename:e})}}}},"28a5":function(t,e,a){"use strict";var r=a("aae3"),s=a("cb7c"),i=a("ebd6"),n=a("0390"),o=a("9def"),l=a("5f1b"),d=a("520a"),c=a("79e5"),u=Math.min,h=[].push,m="split",p="length",g="lastIndex",w=4294967295,f=!c(function(){RegExp(w,"y")});a("214f")("split",2,function(t,e,a,c){var y;return y="c"=="abbc"[m](/(b)*/)[1]||4!="test"[m](/(?:)/,-1)[p]||2!="ab"[m](/(?:ab)*/)[p]||4!="."[m](/(.?)(.?)/)[p]||"."[m](/()()/)[p]>1||""[m](/.?/)[p]?function(t,e){var s=String(this);if(void 0===t&&0===e)return[];if(!r(t))return a.call(s,t,e);var i,n,o,l=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),u=0,m=void 0===e?w:e>>>0,f=new RegExp(t.source,c+"g");while(i=d.call(f,s)){if(n=f[g],n>u&&(l.push(s.slice(u,i.index)),i[p]>1&&i.index<s[p]&&h.apply(l,i.slice(1)),o=i[0][p],u=n,l[p]>=m))break;f[g]===i.index&&f[g]++}return u===s[p]?!o&&f.test("")||l.push(""):l.push(s.slice(u)),l[p]>m?l.slice(0,m):l}:"0"[m](void 0,0)[p]?function(t,e){return void 0===t&&0===e?[]:a.call(this,t,e)}:a,[function(a,r){var s=t(this),i=void 0==a?void 0:a[e];return void 0!==i?i.call(a,s,r):y.call(String(s),a,r)},function(t,e){var r=c(y,t,this,e,y!==a);if(r.done)return r.value;var d=s(t),h=String(this),m=i(d,RegExp),p=d.unicode,g=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(f?"y":"g"),b=new m(f?d:"^(?:"+d.source+")",g),v=void 0===e?w:e>>>0;if(0===v)return[];if(0===h.length)return null===l(b,h)?[h]:[];var R=0,x=0,k=[];while(x<h.length){b.lastIndex=f?x:0;var D,T=l(b,f?h:h.slice(x));if(null===T||(D=u(o(b.lastIndex+(f?0:x)),h.length))===R)x=n(h,x,p);else{if(k.push(h.slice(R,x)),k.length===v)return k;for(var S=1;S<=T.length-1;S++)if(k.push(T[S]),k.length===v)return k;x=R=D}}return k.push(h.slice(R)),k}]})},"2ad7":function(t,e,a){},"6b86":function(t,e,a){"use strict";var r=a("2ad7"),s=a.n(r);s.a}}]);
//# sourceMappingURL=chunk-1669bf66.9681aca3.js.map